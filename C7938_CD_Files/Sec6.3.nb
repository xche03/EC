(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     83668,       2446]
NotebookOptionsPosition[     78327,       2300]
NotebookOutlinePosition[     79212,       2333]
CellTagsIndexPosition[     79169,       2330]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["6.3 Queues", "Section",
 CellFrameColor->GrayLevel[0],
 CellChangeTimes->{{3.425570527908*^9, 3.425570528554*^9}, {
  3.4329147760355997`*^9, 3.4329147776216*^9}, {3.4329228889266*^9, 
  3.4329228934676*^9}},
 TextAlignment->Center,
 FontSize->14,
 FontWeight->"Bold"],

Cell[TextData[{
 "The word \"queue\" is a word used mostly in Great Britain and the former \
empire to refer to a waiting line.  We have all been in them at stores, \
banks, airports and the like.  We the customers come to a facility seeking \
some kind of service.  Most often, our arrival times are not able to be \
predicted with certainty beforehand.  There is some number of servers \
present, and we either join individual lines before them (as in grocery store \
checkout lanes) or we form a single line waiting for the next available \
server (as in most post office counters and amusement park rides).  Some \
rule, most commonly first-in, first-out, is used to select the next customer \
to be served.  Servers take some amount of time, usually random, to serve a \
customer.  When a customer finishes, that customer may be directed to some \
other part of the queueing system (as in a driver's license facility where \
there are several stations to visit), or the customer may depart the system \
for good.  \n\tPredicting the behavior of human queueing systems is certainly \
an interesting problem, to which it is easy to relate.  However, it should be \
noted that it is the study of very large, non-human queueing systems, \
especially those involved with computer and telecommunications networks, \
which gave probability great impetus in the latter ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["20", "th"], TraditionalForm]]],
 " century.  Because instead of human customers and servers we could just as \
easily consider computer jobs or messages in a queue waiting for processing \
by a server or communication channel.  \n\tThere is a wide variety of \
problems in queueing theory, generated by variations in customer arrival and \
facility service patterns, breakdowns of servers, changes in the size of the \
waiting space for customers, rules other than first-in, first-out for \
selecting customers, etc.  Our small section will just touch on the most \
basic of all queues: the so-called ",
 StyleBox["M/M/1 queue",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.4329148529496*^9, 3.4329148705046*^9}, 
   3.4329166992356*^9, {3.4329229035495996`*^9, 3.4329229081336*^9}}],

Cell[TextData[{
 StyleBox["Activity 1",
  FontWeight->"Bold"],
 "  Think of three particular human queueing systems you have been involved \
in.  What main features did they have; for example, how many servers were \
there, were customer arrivals and services random, was the queue a first-in, \
first-out queue, etc.?  Then think of three examples of non-human queueing \
systems."
}], "Text",
 CellFrame->True,
 CellChangeTimes->{3.457127907248927*^9}],

Cell[TextData[{
 "\tHere are the assumptions that identify a queueing system as M/M/1.  \
Customers arrive singly at random times ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "1"], ",", 
    SubscriptBox["T", "2"], ",", 
    SubscriptBox["T", "3"], ",", "..."}], TraditionalForm]]],
 " such that the times between arrivals"
}], "Text",
 CellChangeTimes->{{3.438459979884*^9, 3.438459979887*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["T", "1"], ",", 
   RowBox[{
    SubscriptBox["T", "2"], "-", 
    SubscriptBox["T", "1"]}], ",", 
   RowBox[{
    SubscriptBox["T", "3"], "-", 
    SubscriptBox["T", "2"]}], ",", "..."}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438459986269*^9, 3.4384599866429996`*^9}}],

Cell[TextData[{
 "are i.i.d. exp(\[Lambda]) random variables.  The parameter \[Lambda] is \
called the ",
 StyleBox["arrival rate",
  FontSlant->"Italic"],
 " of the queue.  Therefore, the process that counts the total number of \
customer arrivals by time ",
 StyleBox["t",
  FontSlant->"Italic"],
 " is a Poisson process with rate \[Lambda].  There is a single server (the 1 \
in the notation M/M/1), and customers form one first-come, first-served line \
in front of the server.  Essentially infinite waiting space exists to \
accommodate the customers in queue.  The server requires an exponentially \
distributed length of time with rate \[Mu] for each service, independently of \
the arrival process and other service times.  Customers who finish service \
depart the system.  (By the way, the two \"M\" symbols in the notation stand \
for Markov, because the memoryless nature of the exponential distribution \
makes the arrival and departure processes into continuous-time versions of a \
Markov chain.)",
 "\n",
 "\tOne of the most important quantities to compute in queueing systems is \
the probability distribution of the number of customers in the queue or in \
service, at any time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ".  Such knowledge can help the operators of the system to know whether it \
will be necessary to take action to speed up service in order to avoid \
congestion.  From the customer's point of view, another important quantity is \
the distribution of the customer's waiting time in the queue.  We will \
consider each of these questions in turn for the M/M/1 queue, producing exact \
results for the long-run distributions.  But exact computations become \
difficult even for apparently simple queueing situations, so very often \
analysts must resort to simulating the queue many times to obtain statistical \
estimates of such important quantities as these.  Entire languages, such as \
GPSS, exist to make it easy to program such simulations, but as we will show, \
it is not so hard to write queueing simulation programs even in a very \
general purpose language like ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " which has not been specifically designed for queueing simulation.  "
}], "Text",
 CellChangeTimes->{3.4571283678299274`*^9}],

Cell[TextData[{
 StyleBox["Activity 2",
  FontWeight->"Bold"],
 "  How would you simulate the process of customer arrivals in an M/M/1 \
queue? Try writing a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " command to do this, ignoring the service issue for the moment."
}], "Text",
 CellFrame->True],

Cell[CellGroupData[{

Cell["Long Run Distribution of System Size", "Subsection",
 CellChangeTimes->{3.4354298155699997`*^9},
 FontWeight->"Bold"],

Cell[TextData[{
 "To begin the problem of finding the long-run distribution of the number of \
customers in the queueing system, define ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "t"], TraditionalForm]]],
 " as the number of customers at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ", including the one being served, if any.  Define also a sequence of \
real-valued functions of ",
 StyleBox["t",
  FontSlant->"Italic"],
 ":"
}], "Text",
 CellChangeTimes->{
  3.4329166939266*^9, {3.438460005408*^9, 3.4384600054119997`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["f", "k"], "(", "t", ")"}], "=", 
    RowBox[{
     StyleBox["P",
      FontSlant->"Plain"], "[", 
     RowBox[{
      SubscriptBox["M", "t"], "=", "k"}], "]"}]}], ",", "  ", 
   RowBox[{"k", "=", "0"}], ",", "1", ",", "2", ",", "..."}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460011328*^9, 3.438460011701*^9}}],

Cell[TextData[{
 "If for each ",
 StyleBox["k",
  FontSlant->"Italic"],
 ", the limit as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "\[LongRightArrow]", "\[Infinity]"}], TraditionalForm]]],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "k"], "(", "t", ")"}], TraditionalForm]]],
 " can be found, then these limits ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "k"], TraditionalForm]]],
 " form the limiting probability distribution of system size.  Actually, the \
functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "k"], "(", "t", ")"}], TraditionalForm]]],
 " can be computed themselves, which would give us the short run system size \
distribution, but this is much more difficult than finding the limiting \
distribution and we will not attempt this problem here.  \n\tThe unique \
approach to the problem of finding the limiting distribution is to construct \
a system of differential equations satisfied by the functions ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "k"], "(", "t", ")"}], TraditionalForm]]],
 ".  This illustrates beautifully the power of blending apparently different \
areas of mathematics to solve a real problem.  In the interest of space we \
will leave a few details out and not be completely rigorous.  The interested \
reader can try to fill in some gaps.  \n\tWe first would like to argue that \
the probability that two or more arrival or service events happen in a very \
short time interval is negligibly small.  Consider for example the \
probability that there are two or more arrivals in a short time interval ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ".  Because arrivals to an M/M/1 queue form a Poisson process, we can \
complement, use the Poisson p.m.f., and rewrite the exponential terms in a \
Taylor series as follows:"
}], "Text",
 CellChangeTimes->{
  3.435429829678*^9, {3.438460028678*^9, 3.4384600286800003`*^9}, 
   3.4571284214749274`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{GridBox[{
     {
      RowBox[{
       StyleBox["P",
        FontSlant->"Plain"], "[", 
       RowBox[{"2", " ", "or", " ", "more", " ", "arrivals", " ", "in", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", ",", 
           RowBox[{"t", "+", "h"}]}]}], "]"}]}], "]"}], "=", 
      RowBox[{"1", "-", 
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{"0", " ", "or", " ", "1", " ", "arrival", " ", "in", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"t", ",", 
            RowBox[{"t", "+", "h"}]}]}], "]"}]}], "]"}]}]},
     {" ", "=", 
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["e", 
           RowBox[{
            RowBox[{"-", "\[Lambda]"}], " ", "h"}]], "(", 
          RowBox[{"\[Lambda]", " ", "h"}], ")"}], "0"], 
        RowBox[{"0", "!"}]], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{
          SuperscriptBox["e", 
           RowBox[{
            RowBox[{"-", "\[Lambda]"}], " ", "h"}]], "(", 
          RowBox[{"\[Lambda]", " ", "h"}], ")"}], "1"], 
        RowBox[{"1", "!"}]]}]},
     {" ", "=", 
      RowBox[{"1", "-", 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"-", "\[Lambda]"}], " ", "h"}]], "-", 
       RowBox[{"\[Lambda]", " ", "h", " ", 
        SuperscriptBox["e", 
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], " ", "h"}]]}]}]},
     {" ", "=", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Lambda]", " ", "h"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Lambda]", " ", "h"}], ")"}], "2"]}], "-", 
         "\[CenterEllipsis]"}], ")"}], "-", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"h", "(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Lambda]", " ", "h"}], "+", 
          RowBox[{
           FractionBox["1", "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Lambda]", " ", "h"}], ")"}], "2"]}], "-", 
          "\[CenterEllipsis]"}], ")"}]}]}]},
     {" ", "=", 
      RowBox[{
       RowBox[{
        FractionBox["1", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Lambda]", " ", "h"}], ")"}], "2"]}], "+", 
       RowBox[{"higher", " ", "powers", " ", "of", " ", "h"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}}], " "}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{
  3.435429829678*^9, {3.438460028678*^9, 3.4384600349309998`*^9}}],

Cell[TextData[{
 "So this probability is a small enough function of ",
 StyleBox["h",
  FontSlant->"Italic"],
 " such that if we divide by ",
 StyleBox["h",
  FontSlant->"Italic"],
 " and then send ",
 StyleBox["h",
  FontSlant->"Italic"],
 " to zero, the limit is 0.  Recall from calculus that such a function is \
generically called ",
 Cell[BoxData[
  FormBox[
   RowBox[{"o", "(", "h", ")"}], TraditionalForm]]],
 ".  We can argue similarly that if 2 or more customers are present in the \
system at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ", then the probability that at least 2 customers will be served during ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 " is an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"o", "(", "h", ")"}], TraditionalForm]]],
 " function.  (Try it.)  The activity below leads you through another case of \
two queueing events in a short time."
}], "Text"],

Cell[TextData[{
 StyleBox["Activity 3",
  FontWeight->"Bold"],
 "  Suppose there is at least one customer in the queue and we look at a time \
interval ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 " again. Write one expression for the probability of exactly one arrival in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ", and another for the probability of exactly one service in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ".  Use them to argue that the probability of having both an arrival and a \
service in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"o", "(", "h", ")"}], TraditionalForm]]],
 "."
}], "Text",
 CellFrame->True],

Cell[TextData[{
 "\tAssuming that you are now convinced that the probability of two or more \
queueing events in a time interval of length ",
 StyleBox["h",
  FontSlant->"Italic"],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"o", "(", "h", ")"}], TraditionalForm]]],
 ", let us proceed to derive a differential equation for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "(", "t", ")"}], "=", 
    RowBox[{
     StyleBox["P",
      FontSlant->"Plain"], "[", 
     RowBox[{
      SubscriptBox["M", "t"], "=", "0"}], "]"}]}], TraditionalForm]]],
 " by setting up a difference quotient"
}], "Text",
 CellChangeTimes->{{3.4384600602390003`*^9, 3.438460062825*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{" ", 
   FormBox[
    FractionBox[
     RowBox[{
      RowBox[{
       SubscriptBox["f", "0"], "(", 
       RowBox[{"t", "+", "h"}], ")"}], "-", 
      RowBox[{
       SubscriptBox["f", "0"], "(", "t", ")"}]}], "h"],
    TraditionalForm]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460069543*^9, 3.438460070074*^9}}],

Cell[TextData[{
 "Now ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "(", 
     RowBox[{"t", "+", "h"}], ")"}], "=", 
    RowBox[{
     StyleBox["P",
      FontSlant->"Plain"], "[", 
     RowBox[{
      SubscriptBox["M", 
       RowBox[{"t", "+", "h"}]], "=", "0"}], "]"}]}], TraditionalForm]]],
 ", so let us consider how the system size could have come to be 0 at time ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "+", "h"}], TraditionalForm]]],
 ", conditioning on the system size at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ".  There are two main cases, 1 and 2 below, and a collection of others \
described in case 3 that involve two or more queueing events in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ", which therefore have probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"o", "(", "h", ")"}], TraditionalForm]]],
 ":"
}], "Text"],

Cell[TextData[{
 "\t1.  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "t"], "=", "0"}], TraditionalForm]]],
 ", and there were no arrivals in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ";\n\t2.  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "t"], "=", "1"}], TraditionalForm]]],
 ", and there was one service and no new arrivals in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ";\n\t3.  Neither 1 nor 2 hold, and all existing and newly arriving \
customers are served in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 "."
}], "Text"],

Cell[TextData[{
 "The total probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["P",
     FontSlant->"Plain"], "[", 
    RowBox[{
     SubscriptBox["M", 
      RowBox[{"t", "+", "h"}]], "=", "0"}], "]"}], TraditionalForm]]],
 " is the sum of the probabilities of the three cases.  But the probability \
of no arrivals in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], " ", "h"}]], "=", 
    RowBox[{"1", "-", 
     RowBox[{"\[Lambda]", " ", "h"}], "+", 
     RowBox[{"o", "(", "h", ")"}]}]}], TraditionalForm]]],
 " and the probability of exactly one service is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Mu]", " ", "h", " ", 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", "\[Mu]"}], " ", "h"}]]}], "=", 
    RowBox[{
     RowBox[{"\[Mu]", " ", 
      RowBox[{"h", "(", 
       RowBox[{"1", "-", 
        RowBox[{"\[Mu]", " ", "h"}], "+", 
        RowBox[{"o", "(", "h", ")"}]}], ")"}]}], "=", 
     RowBox[{
      RowBox[{"\[Mu]", " ", "h"}], "+", 
      RowBox[{"o", "(", "h", ")"}]}]}]}], TraditionalForm]]],
 ".  By independence, the probability of one service and no new arrivals is \
therefore ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Lambda]", " ", "h"}], "+", 
       RowBox[{"o", "(", "h", ")"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Mu]", " ", "h"}], "+", 
       RowBox[{"o", "(", "h", ")"}]}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"\[Mu]", " ", "h"}], "+", 
     RowBox[{"o", "(", "h", ")"}]}]}], TraditionalForm]]],
 ".  Thus, by the Law of Total Probability,"
}], "Text",
 CellChangeTimes->{{3.438460085487*^9, 3.438460085492*^9}}],

Cell[BoxData[
 FormBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       SubscriptBox["f", "0"], "(", 
       RowBox[{"t", "+", "h"}], ")"}], "=", 
      RowBox[{
       StyleBox["P",
        FontSlant->"Plain"], "[", 
       RowBox[{
        SubscriptBox["M", 
         RowBox[{"t", "+", "h"}]], "=", "0"}], "]"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{
         SubscriptBox["M", "t"], "=", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Lambda]", " ", "h"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{
         SubscriptBox["M", "t"], "=", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"\[Mu]", " ", "h"}], ")"}]}], "+", 
      RowBox[{"o", "(", "h", ")"}]}]},
    {" ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Lambda]", " ", "h"}]}], ")"}], 
       RowBox[{
        SubscriptBox["f", "0"], "(", "t", ")"}]}], "+", 
      RowBox[{"\[Mu]", " ", "h", " ", 
       RowBox[{
        SubscriptBox["f", "1"], "(", "t", ")"}]}], " ", "+", " ", 
      RowBox[{"o", "(", "h", ")"}]}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.4384600914960003`*^9, 3.4384600918929996`*^9}}],

Cell[TextData[{
 "Subtracting ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "0"], "(", "t", ")"}], TraditionalForm]]],
 " from both sides, and then dividing by ",
 StyleBox["h",
  FontSlant->"Italic"],
 " and sending ",
 StyleBox["h",
  FontSlant->"Italic"],
 " to zero yields"
}], "Text",
 CellChangeTimes->{{3.438460106099*^9, 3.438460106104*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{" ", 
   FormBox[
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["f", "0"], "(", 
         RowBox[{"t", "+", "h"}], ")"}], "-", 
        RowBox[{
         SubscriptBox["f", "0"], "(", "t", ")"}]}], "h"], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Lambda]"}], " ", 
        RowBox[{
         SubscriptBox["f", "0"], "(", "t", ")"}]}], "+", 
       RowBox[{"\[Mu]", " ", 
        RowBox[{
         SubscriptBox["f", "1"], "(", "t", ")"}]}], "+", 
       FractionBox[
        RowBox[{"o", "(", "h", ")"}], "h"]}]}], "\[IndentingNewLine]", 
     "       ", 
     RowBox[{
      RowBox[{"\[DoubleLongRightArrow]", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["f", "0"], "\[Prime]"], "(", "t", ")"}]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[Lambda]"}], " ", 
        RowBox[{
         SubscriptBox["f", "0"], "(", "t", ")"}]}], "+", 
       RowBox[{"\[Mu]", " ", 
        RowBox[{
         SubscriptBox["f", "1"], "(", "t", ")"}]}]}]}]}],
    TraditionalForm]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.4384601133310003`*^9, 3.438460116559*^9}}],

Cell["\<\
\tEquation (4) is one of the equations in the infinite system of equations we \
seek.  You are asked to show in Exercise 3 that the rest of the differential \
equations have the form:\
\>", "Text",
 CellChangeTimes->{{3.4384601305150003`*^9, 3.43846013052*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{" ", 
   RowBox[{
    FormBox[
     RowBox[{
      RowBox[{
       SuperscriptBox[
        SubscriptBox["f", "k"], "\[Prime]"], "(", "t", ")"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}]}], "  ", 
        RowBox[{
         SubscriptBox["f", "k"], "(", "t", ")"}]}], "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{
         SubscriptBox["f", 
          RowBox[{"k", "-", "1"}]], "(", "t", ")"}]}], "+", 
       RowBox[{"\[Mu]", " ", 
        RowBox[{
         SubscriptBox["f", 
          RowBox[{"k", "+", "1"}]], "(", "t", ")"}]}]}]}],
     TraditionalForm], ",", "  ", 
    FormBox[
     RowBox[{"k", "\[GreaterEqual]", "1"}],
     TraditionalForm]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460137066*^9, 3.438460137422*^9}}],

Cell[TextData[{
 "Intuitively, the first term on the right side of (5) represents the case of \
neither an arrival nor a service during ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ", the second term is for the case where there were ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "-", "1"}], TraditionalForm]]],
 " customers at time ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]]],
 " and one new arrival appeared in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ", and the third term corresponds to the case where there were ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "+", "1"}], TraditionalForm]]],
 " customers at time ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]]],
 ", and one customer was served in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ",", 
      RowBox[{"t", "+", "h"}]}]}], "]"}], TraditionalForm]]],
 ".  ",
 "\n",
 "\tThe system of differential equations (4) and (5) can be solved with a lot \
of effort (see [Gross and Harris, p. 129]), but we will just use the system \
to derive and solve an ordinary system of linear equations for the limiting \
probabilities ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "k"], "=", 
    RowBox[{
     RowBox[{
      UnderscriptBox["lim", 
       RowBox[{"t", "\[LongRightArrow]", "\[Infinity]"}]], 
      RowBox[{
       SubscriptBox["f", "k"], "(", "t", ")"}]}], "=", 
     RowBox[{
      UnderscriptBox["lim", 
       RowBox[{"t", "\[LongRightArrow]", "\[Infinity]"}]], 
      RowBox[{
       StyleBox["P",
        FontSlant->"Plain"], "[", 
       RowBox[{
        SubscriptBox["M", "t"], "=", "k"}], "]"}]}]}]}], TraditionalForm]]],
 ".  ",
 "\n",
 "\tObserve that if the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "k"], "(", "t", ")"}], TraditionalForm]]],
 " functions are approaching a limit, there is reason to believe that the \
derivatives ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["f", "k"], "\[Prime]"], "(", "t", ")"}], TraditionalForm]]],
 " approach zero.  Presuming that this is so, we can send ",
 StyleBox["t",
  FontSlant->"Italic"],
 " to \[Infinity] in (4) and (5) to obtain the system of linear equations:"
}], "Text",
 CellChangeTimes->{{3.438460159557*^9, 3.438460159561*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{" ", 
   FormBox[
    TagBox[
     StyleBox[
      RowBox[{
       StyleBox["{",
        ShowAutoStyles->False], 
       StyleBox[GridBox[{
          {
           StyleBox[
            RowBox[{"0", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "\[Lambda]"}], "  ", 
               SubscriptBox["f", "0"]}], "+", 
              RowBox[{"\[Mu]", " ", 
               SubscriptBox["f", "1"]}]}]}],
            GridBoxOptions->{
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}}]},
          {
           StyleBox[
            RowBox[{
             RowBox[{"0", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}]}], "  ", 
                SubscriptBox["f", "k"]}], "+", 
               RowBox[{"\[Lambda]", " ", 
                SubscriptBox["f", 
                 RowBox[{"k", "-", "1"}]]}], "+", 
               RowBox[{"\[Mu]", " ", 
                SubscriptBox["f", 
                 RowBox[{"k", "+", "1"}]]}]}]}], ",", 
             RowBox[{"k", "\[GreaterEqual]", "1"}]}],
            GridBoxOptions->{
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}}}]}
         }],
        ShowAutoStyles->True]}],
      GridBoxOptions->{
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}}}],
     #& ],
    TraditionalForm]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460166045*^9, 3.438460166408*^9}}],

Cell[TextData[{
 "We can adjoin to this system the condition that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "+", 
     SubscriptBox["f", "1"], "+", 
     SubscriptBox["f", "2"], "+", "\[CenterEllipsis]"}], "=", "1"}], 
   TraditionalForm]]],
 " in order to force the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "k"], TraditionalForm]]],
 "'s to form a valid probability distribution.  Now the top equation in (6) \
implies"
}], "Text",
 CellChangeTimes->{{3.4384601784890003`*^9, 3.438460178493*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["f", "1"], "=", 
   RowBox[{
    FractionBox["\[Lambda]", "\[Mu]"], 
    SubscriptBox["f", "0"]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460184828*^9, 3.4384601851470003`*^9}}],

Cell[TextData[{
 "When ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", "1"}], TraditionalForm]]],
 ", the bottom equation in (6) implies"
}], "Text",
 CellChangeTimes->{{3.438460196968*^9, 3.4384601969709997`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{" ", 
   FormBox[
    RowBox[{
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       SubscriptBox["f", "2"]}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}], 
         SubscriptBox["f", "1"]}], "-", 
        RowBox[{"\[Lambda]", " ", 
         SubscriptBox["f", "0"]}]}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "+", "\[Mu]"}], ")"}], 
          FractionBox["\[Lambda]", "\[Mu]"], 
          SubscriptBox["f", "0"]}], "-", 
         RowBox[{"\[Lambda]", " ", 
          SubscriptBox["f", "0"]}]}], "=", 
        RowBox[{
         FractionBox[
          SuperscriptBox["\[Lambda]", "2"], "\[Mu]"], 
         SubscriptBox["f", "0"]}]}]}]}], "\[IndentingNewLine]", GridBox[{
       {
        RowBox[{"                           ", "\[DoubleLongRightArrow]"}], 
        RowBox[{
         SubscriptBox["f", "2"], "=", 
         RowBox[{
          FractionBox[
           SuperscriptBox["\[Lambda]", "2"], 
           SuperscriptBox["\[Mu]", "2"]], 
          SubscriptBox["f", "0"]}]}]}
      }]}],
    TraditionalForm]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460203233*^9, 3.4384602035880003`*^9}}],

Cell[TextData[{
 StyleBox["Activity 4",
  FontWeight->"Bold"],
 "   Check that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "3"], "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox["\[Lambda]", "3"], 
      SuperscriptBox["\[Mu]", "3"]], 
     SubscriptBox["f", "0"]}]}], TraditionalForm]]],
 "."
}], "Text",
 CellFrame->True],

Cell[TextData[{
 "\tIn Exercise 4 we ask you to show inductively that for each ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[GreaterEqual]", "1"}], TraditionalForm]]],
 ","
}], "Text",
 CellChangeTimes->{{3.43846021884*^9, 3.438460218842*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["f", "k"], "=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["\[Lambda]", "k"], 
     SuperscriptBox["\[Mu]", "k"]], 
    SubscriptBox["f", "0"], " "}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.43846021884*^9, 3.43846022524*^9}}],

Cell[TextData[{
 "Clearly though, in order for the sum of the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", "k"], TraditionalForm]]],
 "'s to be 1, or to be finite at all, the ratio \[Rho] = \[Lambda]/\[Mu] must \
be less than 1.  This ratio \[Rho] is called the ",
 StyleBox["traffic intensity",
  FontSlant->"Italic"],
 " of the M/M/1 queue, a good name because it compares the arrival rate to \
the service rate.  If \[Rho] < 1, then \[Mu] > \[Lambda], and the server \
works fast enough to keep up with the arrivals.   I will leave it to you to \
show that under the condition ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[CapitalSigma]", 
      RowBox[{"k", "=", "0"}], "\[Infinity]"], " ", 
     SubscriptBox["f", "k"]}], "=", "1"}], TraditionalForm]]],
 ", the limiting M/M/1 queue system size probabilities are"
}], "Text",
 CellChangeTimes->{{3.438460241355*^9, 3.438460241358*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["f", "k"], "=", 
    RowBox[{
     RowBox[{
      UnderscriptBox["lim", 
       RowBox[{"t", "\[LongRightArrow]", "\[Infinity]"}]], 
      RowBox[{
       StyleBox["P",
        FontSlant->"Plain"], "[", 
       RowBox[{
        SubscriptBox["M", "t"], "=", "k"}], "]"}]}], "=", 
     RowBox[{
      SuperscriptBox["\[Rho]", "k"], "(", 
      RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ",", " ", 
   RowBox[{"k", "=", "0"}], ",", "1", ",", "2", ",", "...", " "}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460241355*^9, 3.438460247814*^9}}],

Cell[TextData[{
 "\tSo we see that the limiting system size has the geometric distribution \
with parameter ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "-", "\[Rho]"}], TraditionalForm]]],
 " (see formula (1) of Section 2.3).  An interesting consequence is that the \
average number of customers in the system is"
}], "Text",
 CellChangeTimes->{{3.438460262311*^9, 3.438460262321*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"L", "=", 
   FractionBox["\[Rho]", 
    RowBox[{"1", "-", "\[Rho]"}]], " "}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460262311*^9, 3.43846026919*^9}}],

Cell["\<\
From this expression, notice that as the traffic intensity \[Rho] increases \
toward 1, the average system size increases to \[Infinity], which is \
intuitively reasonable.\
\>", "Text"],

Cell[TextData[{
 StyleBox["Example 1",
  FontWeight->"Bold"],
 "  At a shopping mall amusement area, customers wanting to buy tokens for \
the machines form a first-in, first-out line in front of a booth staffed by a \
single clerk.  The customers arrive according to a Poisson process with rate \
3/min., and the server can serve at an average time of 15 sec. per customer.  \
Find the distribution and average value of the number of customers awaiting \
service.  Suppose that replacing the booth clerk by a machine costs $2000 for \
the machine itself plus an estimated $.50 per hour for power and maintenance, \
and with this self-service plan customers could serve themselves at an \
average time of 12 sec. apiece.  The human server is paid $5/hr.  Also, an \
estimate of the intangible cost of inconvenience to customers is $.20 per \
waiting customer per minute.  Is it worthwhile to replace the clerk by the \
machine? \n\tThe given information lets us assume that the times between \
customer arrivals are exponentially distributed with rate parameter \[Lambda] \
= 3/min.  If we are willing to assume that service times are independent \
exponential random variables, which are furthermore independent of arrivals, \
then the M/M/1 assumptions are met.  The service rate is the reciprocal of \
the mean service time, which is 1/(1/4 min.) = 4/min.  Thus the queue traffic \
intensity is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     RowBox[{"\[Lambda]", "/", "\[Mu]"}], "=", 
     RowBox[{"3", "/", "4"}]}]}], TraditionalForm]]],
 ".  By formula (8) the long-run probability of ",
 StyleBox["k",
  FontSlant->"Italic"],
 " customers in the system is"
}], "Text",
 CellChangeTimes->{{3.438460295792*^9, 3.438460295797*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["f", "k"], "=", 
    RowBox[{
     FractionBox["1", "4"], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox["3", "4"], ")"}], "k"]}]}], ",", " ", 
   RowBox[{"k", "=", "0"}], ",", "1", ",", "2", ",", "...", " "}], 
  TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460295792*^9, 3.438460302712*^9}}],

Cell["\<\
and by formula (9) the average number of customers in the system is\
\>", "Text",
 CellChangeTimes->{{3.438460316297*^9, 3.4384603163050003`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"L", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"3", "/", "4"}], 
     RowBox[{"1", "-", 
      RowBox[{"3", "/", "4"}]}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"3", "/", "4"}], 
      RowBox[{"1", "/", "4"}]], "=", "3"}]}]}], 
  TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460322666*^9, 3.438460323139*^9}}],

Cell[TextData[{
 "\tTo answer the second question, we must compute the average cost per \
minute ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "h"], TraditionalForm]]],
 " for the human server system and the average cost per minute of the machine \
system ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "m"], TraditionalForm]]],
 ".  Note that the total cost for ",
 StyleBox["x",
  FontSlant->"Italic"],
 " minutes of operations under the human system is just ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["C", "h"], "x"}], TraditionalForm]]],
 ", but because of the fixed purchase cost of the machine, the total cost for \
",
 StyleBox["x",
  FontSlant->"Italic"],
 " minutes is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["C", "m"], "x"}], "+", "2000"}], TraditionalForm]]],
 " under the machine scenario. For consistency let us express all monetary \
units in dollars and all times in minutes.  Then for instance the clerk's pay \
rate is ($5/hr.)/(60 min./hr.) = $(1/12)/min., and the cost of operation of \
the machine is ($.50/hr.)/(60 min./hr) = $(1/120)/min.  Now in calculating ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "h"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "m"], TraditionalForm]]],
 " there are two aspects of cost to consider: operating cost and the overall \
cost to waiting customers.  The latter would be the average number of \
customers waiting, times the cost rate of $.20/min. per customer.  For the \
human server system, the overall cost per minute would be"
}], "Text",
 CellChangeTimes->{{3.438460337014*^9, 3.438460337019*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["C", "h"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"$", "(", 
       RowBox[{"1", "/", "12"}], ")"}], "/", 
      RowBox[{"min", ".", 
       RowBox[{"+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"3", " ", "customers"}], ")"}], "\[Cross]", 
         RowBox[{"(", 
          RowBox[{"$", 
           RowBox[{".20", "/", "customer"}]}], ")"}]}]}]}]}], "/", 
     RowBox[{"min", "."}]}], "=", 
    RowBox[{"$", 
     RowBox[{".683", "/", 
      RowBox[{"min", "."}]}]}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.4384603441070004`*^9, 3.4384603444449997`*^9}}],

Cell[TextData[{
 "Since the machine average service time is 12 sec. = 1/5 min., its service \
rate is 5/min. and the resulting queue traffic intensity is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     RowBox[{"\[Lambda]", "/", "\[Mu]"}], "=", 
     RowBox[{"3", "/", "5"}]}]}], TraditionalForm]]],
 ".  The average number of customers in the system under the machine scenario \
is therefore"
}], "Text",
 CellChangeTimes->{{3.438460356543*^9, 3.438460356546*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"L", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"3", "/", "5"}], 
     RowBox[{"1", "-", 
      RowBox[{"3", "/", "5"}]}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"3", "/", "5"}], 
      RowBox[{"2", "/", "5"}]], "=", 
     FractionBox["3", "2"], " "}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460356543*^9, 3.438460362849*^9}}],

Cell["Thus the overall cost per minute for the machine system is", "Text",
 CellChangeTimes->{{3.43846037205*^9, 3.438460372061*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["C", "h"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"$", "(", 
       RowBox[{"1", "/", "120"}], ")"}], "/", 
      RowBox[{"min", ".", 
       RowBox[{"+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", "/", "2"}], " ", "customers"}], ")"}], "\[Cross]", 
         RowBox[{"(", 
          RowBox[{"$", 
           RowBox[{".20", "/", "customer"}]}], ")"}]}]}]}]}], "/", 
     RowBox[{"min", "."}]}], "=", 
    RowBox[{"$", 
     RowBox[{".308", "/", 
      RowBox[{"min", "."}]}]}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460378876*^9, 3.4384603792279997`*^9}}],

Cell[TextData[{
 "The cost rate for the machine is less than half that of the human server.  \
And notice that the bigger factor in the improvement was not the running cost \
but the savings in customer waiting cost.  Taking into account the purchase \
cost, the use of the machine becomes economical after it has been used for at \
least ",
 StyleBox["x",
  FontSlant->"Italic"],
 " minutes, where ",
 StyleBox["x",
  FontSlant->"Italic"],
 " satisfies"
}], "Text",
 CellChangeTimes->{{3.43846039008*^9, 3.438460390091*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["C", "h"], " ", "x"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["C", "m"], " ", "x"}], "+", 
     RowBox[{
      RowBox[{"2000", "\[DoubleLongRightArrow]", ".683"}], " ", "x"}]}], " ", 
    "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{".308", " ", "x"}], "+", 
      RowBox[{
       RowBox[{"2000", "\[DoubleLongRightArrow]", ".375"}], "x"}]}], "=", 
     "2000"}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460396071*^9, 3.4384603963859997`*^9}}],

Cell[TextData[{
 "The solution value for ",
 StyleBox["x",
  FontSlant->"Italic"],
 " turns out to be about 5333 minutes, or about 89 hours.  If the arcade is \
open for 10/hrs. per day, then before 9 working days have elapsed the machine \
will have begun to be less costly than the human server.  ",
 "\[FilledSquare]"
}], "Text",
 CellChangeTimes->{{3.4329166664086*^9, 3.4329166664096003`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Waiting Time Distribution", "Subsection",
 FontWeight->"Bold"],

Cell[TextData[{
 "The second major question that we will address is the distribution of the \
waiting time of a customer who arrives to an M/M/1 queue at some time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ".  There are two things that we might mean by this: the time ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "q"], TraditionalForm]]],
 " that a customer spends in queue prior to entering service, or the time ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]]],
 " spent in the system in total, including the customer's time in service.  \
We will work on ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]]],
 ", saving the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "q"], TraditionalForm]]],
 " problem for the exercises.  \n\tAssume that the queue has reached \
equilibrium, so that we are really looking at the limiting distribution as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "\[LongRightArrow]", "\[Infinity]"}], TraditionalForm]]],
 " of the waiting time ",
 StyleBox["W",
  FontSlant->"Italic"],
 " of a customer who arrives at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ".  This allows us to make use of the limiting system size probabilities in \
formula (8).\n\tWhen our customer arrives, there is some number ",
 StyleBox["n ",
  FontSlant->"Italic"],
 "\[GreaterEqual] 0 of customers ahead.  Because of the memoryless property \
of the exponential service time distribution, the distribution of the waiting \
time is the same as if the customer currently in service, if any, just began \
that service.  So if ",
 StyleBox["n",
  FontSlant->"Italic"],
 " customers are ahead, the waiting time in system of the new customer will \
be the total ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["U", "1"], "+", 
    SubscriptBox["U", "2"], "+", "\[CenterEllipsis]", "+", 
    SubscriptBox["U", 
     RowBox[{"n", "+", "1"}]]}], TraditionalForm]]],
 " of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "+", "1"}], TraditionalForm]]],
 " independent exp(\[Mu]) distributed service times (including the new \
customer as well as the ",
 StyleBox["n ",
  FontSlant->"Italic"],
 "customers ahead).  Remember that the moment-generating function method \
implies that the distribution of the sum of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "+", "1"}], TraditionalForm]]],
 " independent exp(\[Mu]) = \[CapitalGamma](1, 1/\[Mu]) random variables is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalGamma]", "(", 
    RowBox[{
     RowBox[{"n", "+", "1"}], ",", 
     RowBox[{"1", "/", "\[Mu]"}]}], ")"}], TraditionalForm]]],
 ".  So, conditioned on the event that there is a particular number ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "\[GreaterEqual]", "0"}], TraditionalForm]]],
 " of customers in the system upon the arrival of the new customer, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"W", "\[Tilde]", 
    RowBox[{"\[CapitalGamma]", "(", 
     RowBox[{
      RowBox[{"n", "+", "1"}], ",", 
      RowBox[{"1", "/", "\[Mu]"}]}], ")"}]}], TraditionalForm]]],
 ".  By the Law of Total Probability we can write the limiting c.d.f. of ",
 Cell[BoxData[
  FormBox["W", TraditionalForm]]],
 " as"
}], "Text",
 CellChangeTimes->{3.4329166845386*^9, {3.43846041516*^9, 3.438460415166*^9}}],

Cell[BoxData[
 FormBox[GridBox[{
    {
     FormBox[
      RowBox[{
       RowBox[{"F", "(", "s", ")"}], "=", 
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{"W", "\[LessEqual]", "s"}], "]"}]}],
      TraditionalForm], "=", 
     FormBox[
      RowBox[{
       UnderoverscriptBox["\[CapitalSigma]", 
        RowBox[{"n", "=", "0"}], "\[Infinity]"], " ", 
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{
         RowBox[{"W", "\[LessEqual]", "s"}], " ", "|", " ", 
         RowBox[{"n", " ", "in", " ", "system"}]}], "]"}], 
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{"n", " ", "in", " ", "system"}], "]"}]}],
      TraditionalForm]},
    {" ", "=", 
     FormBox[
      RowBox[{
       RowBox[{
        UnderoverscriptBox["\[CapitalSigma]", 
         RowBox[{"n", "=", "0"}], "\[Infinity]"], "(", 
        RowBox[{
         UnderoverscriptBox["\[Integral]", "0", "s"], " ", 
         RowBox[{
          FractionBox[
           SuperscriptBox["\[Mu]", 
            RowBox[{"n", "+", "1"}]], 
           RowBox[{"\[CapitalGamma]", "(", 
            RowBox[{"n", "+", "1"}], ")"}]], 
          SuperscriptBox["x", "n"], 
          SuperscriptBox["e", 
           RowBox[{
            RowBox[{"-", "\[Mu]"}], " ", "x"}]], " ", "d", " ", "x"}]}], 
        ")"}], 
       RowBox[{
        SuperscriptBox["\[Rho]", "n"], "(", 
        RowBox[{"1", "-", "\[Rho]"}], ")"}]}],
      TraditionalForm]},
    {" ", "=", 
     FormBox[
      RowBox[{
       RowBox[{"\[Mu]", "(", 
        RowBox[{"1", "-", "\[Rho]"}], ")"}], 
       UnderoverscriptBox[
        RowBox[{"\[Integral]", " "}], "0", "s"], 
       RowBox[{
        SuperscriptBox["e", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], " ", "x"}]], "(", 
        RowBox[{
         UnderoverscriptBox["\[CapitalSigma]", 
          RowBox[{"n", "=", "0"}], "\[Infinity]"], " ", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Mu]", " ", "x", " ", "\[Rho]"}], ")"}], "n"], 
          RowBox[{"n", "!"}]]}], ")"}], "d", " ", "x"}],
      TraditionalForm]},
    {" ", "=", 
     FormBox[
      RowBox[{
       RowBox[{"\[Mu]", "(", 
        RowBox[{"1", "-", "\[Rho]"}], ")"}], 
       UnderoverscriptBox[
        RowBox[{"\[Integral]", " "}], "0", "s"], 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], " ", "x"}]], " ", 
       SuperscriptBox["e", 
        RowBox[{"\[Mu]", " ", "x", " ", "\[Rho]"}]], " ", "d", " ", "x"}],
      TraditionalForm]},
    {" ", "=", 
     FormBox[
      RowBox[{
       RowBox[{"\[Mu]", "(", 
        RowBox[{"1", "-", "\[Rho]"}], ")"}], 
       UnderoverscriptBox[
        RowBox[{"\[Integral]", " "}], "0", "s"], 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], " ", 
         RowBox[{"x", "(", 
          RowBox[{"1", "-", "\[Rho]"}], ")"}]}]], " ", "d", " ", "x"}],
      TraditionalForm]},
    {" ", "=", 
     FormBox[
      RowBox[{"1", "-", 
       SuperscriptBox["e", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"\[Mu]", "(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}]}], "s"}]]}],
      TraditionalForm]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.438460422141*^9, 3.438460422584*^9}}],

Cell[TextData[{
 "\tHence, ",
 StyleBox["W",
  FontSlant->"Italic"],
 " has density function"
}], "Text",
 CellChangeTimes->{{3.438460443402*^9, 3.438460443407*^9}, 
   3.457128657852927*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"f", "(", "s", ")"}], "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["F", "\[Prime]"], "(", "s", ")"}], "=", 
    RowBox[{
     RowBox[{"\[Mu]", "(", 
      RowBox[{"1", "-", "\[Rho]"}], ")"}], 
     SuperscriptBox["e", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"\[Mu]", "(", 
         RowBox[{"1", "-", "\[Rho]"}], ")"}]}], "s"}]]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.43846045108*^9, 3.438460451473*^9}}],

Cell[TextData[{
 "which we recognize as the ",
 Cell[BoxData[
  FormBox[
   RowBox[{"exp", "(", 
    RowBox[{"\[Mu]", "(", 
     RowBox[{"1", "-", "\[Rho]"}], ")"}], ")"}], TraditionalForm]]],
 " distribution.  It follows that the long-run mean waiting time is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     StyleBox["E",
      FontSlant->"Plain"], "[", "W", "]"}], "=", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"\[Mu]", "(", 
       RowBox[{"1", "-", "\[Rho]"}], ")"}], ")"}]}]}], TraditionalForm]]],
 ", which is intuitively reasonable.  As the traffic intensity \[Rho] \
increases toward 1, the equilibrium queue length increases, thus increasing \
the average waiting time of the new customer.  Also, as the service rate \
\[Mu] increases, the average waiting time decreases.  Note also that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Mu]", "(", 
     RowBox[{"1", "-", "\[Rho]"}], ")"}], "=", 
    RowBox[{
     RowBox[{"\[Mu]", "(", 
      RowBox[{"1", "-", 
       RowBox[{"\[Lambda]", "/", "\[Mu]"}]}], ")"}], "=", 
     RowBox[{"\[Mu]", "-", "\[Lambda]"}]}]}], TraditionalForm]]],
 ", so that the closer \[Lambda] is to \[Mu], the longer is the expected wait."
}], "Text"],

Cell[TextData[{
 StyleBox["Example 2",
  FontWeight->"Bold"],
 "   Suppose that a warehouse processes orders for shipment one at a time.  \
The orders come in at a rate of 4 per hour, forming a Poisson process.  Under \
normal working conditions, a team of order fillers working on preparing the \
order can complete an order in an exponential amount of time with rate 4.2 \
per hour.  Hence the team can just barely keep up with input.  What is the \
average time for a newly arriving order to be completed?  If more people can \
be assigned to the team, the service rate can be increased.  To what must the \
service rate be increased so that orders require no more than one hour of \
waiting on average from start to finish?  ",
 "\n",
 "\tWe are given that \[Lambda] = 4.0/hr., and the default service rate is \
\[Mu] = 4.2/hr.  Hence the traffic intensity is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     RowBox[{"4.0", "/", "4.2"}], "=", ".952"}]}], TraditionalForm]]],
 ", and the expected waiting time in equilibrium is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4.2", 
       RowBox[{"(", 
        RowBox[{"1", "-", ".952"}], ")"}]}], ")"}]}], "\[TildeTilde]", 
    "4.96"}], TraditionalForm]]],
 ".  This is an excessive amount of time for an order.  To answer the second \
question, we need to choose \[Mu] such that"
}], "Text",
 CellChangeTimes->{{3.438460471032*^9, 3.4384604710360003`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    StyleBox["E",
     FontSlant->"Plain"], "[", "W", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Mu]", "-", "\[Lambda]"}]], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Mu]", "-", "4"}]], "\[LessEqual]", 
     RowBox[{
      RowBox[{"1", "\[DoubleLongRightArrow]", "\[Mu]"}], "-", "4"}], 
     "\[GreaterEqual]", 
     RowBox[{"1", "\[DoubleLongRightArrow]", "\[Mu]"}], "\[GreaterEqual]", 
     "5"}]}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.438460476977*^9, 3.438460477304*^9}}],

Cell["\<\
So an increase in service rate from 4.2 to just 5 per hour is enough to cut \
the average waiting time from about 5 hours to 1 hour.  \[FilledSquare]\
\>", "Text",
 CellChangeTimes->{{3.4329168709476*^9, 3.4329168709486*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulating Queues", "Subsection",
 FontWeight->"Bold"],

Cell[TextData[{
 "Consider a single-server first-in, first-out queue as before except that we \
generalize: (1) the distribution of customer interarrival times; and (2) the \
distribution of customer service times.  We have so far treated only the case \
where both of these distributions are exponential.  It is much harder, and \
sometimes impossible, to get analytical results about waiting times and \
limiting distributions for general interarrival and service distributions; so \
it is important to be able to estimate these quantities by observing the \
results of simulation.  Simulation can also be used in more complicated cases \
than single-server first-in, first-out queues, but we will not treat such \
problems here.  \n\t It is very easy in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to simulate a sequence of arrival times with a given interarrival \
distribution.  Notice that the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "th"], TraditionalForm]]],
 " arrival time ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", "n"], TraditionalForm]]],
 " is the sum of the first ",
 StyleBox["n",
  FontSlant->"Italic"],
 " interarrival times. The following utility function takes advantage of this \
observation by keeping a running sum of interarrival times, simulating the \
next one, and adjoining the updated running sum to the end of a list of \
arrival times.  The arguments to the function are the interarrival \
distribution and the number of arrivals to simulate, and the output is the \
list of arrival times."
}], "Text",
 CellChangeTimes->{
  3.4329170851666*^9, {3.4329171334296*^9, 3.4329171349435997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimArrivals", "[", 
   RowBox[{"arrdist_", ",", "numarrs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"arrtimelist", ",", "currtime", ",", "nextinterarr"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arrtimelist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"currtime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nextinterarr", "=", 
         RowBox[{"RandomReal", "[", "arrdist", "]"}]}], ";", 
        "\[IndentingNewLine]", "    ", 
        RowBox[{"currtime", "=", 
         RowBox[{"currtime", "+", "nextinterarr"}]}], ";", 
        "\[IndentingNewLine]", "    ", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"arrtimelist", ",", "currtime"}], "]"}]}], ",", 
       RowBox[{"{", "numarrs", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "arrtimelist"}]}], "]"}]}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{{3.404318041015625*^9, 3.4043180420625*^9}},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[BoxData[
 RowBox[{"SeedRandom", "[", "787632", "]"}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[BoxData[
 RowBox[{"SimArrivals", "[", 
  RowBox[{
   RowBox[{"ExponentialDistribution", "[", "3", "]"}], ",", "4"}], 
  "]"}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell["\<\
\tIt is even easier to simulate a list of service times for those customers.  \
We just simulate a table of the desired number of observations from the \
desired distribution, as in the next command.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimServiceTimes", "[", 
   RowBox[{"servicedist_", ",", "numservices_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"servicedist", ",", 
    RowBox[{"{", "numservices", "}"}]}], "]"}]}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{{3.404318073*^9, 3.40431807428125*^9}},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[BoxData[
 RowBox[{"SimServiceTimes", "[", 
  RowBox[{
   RowBox[{"ExponentialDistribution", "[", "4", "]"}], ",", "4"}], 
  "]"}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[TextData[{
 "\tAll of the behavior of the queue is determined by these lists of arrival \
and service times, but there is still the considerable problem of extracting \
information from the lists.  As an example let us consider the relatively \
easy problem of finding from a simulated queueing process a list of customer \
waiting times.  \n\tThink of the queueing behavior for the simulated output \
above.  Customer 1 arrives at time .519352.  It takes .429965 time units to \
serve this customer, who therefore departs at time ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{".519352", "+", ".429965"}], "=", ".949317"}], TraditionalForm]]],
 ".  Customer 2 arrives at time .770897, at which time customer 1 is still in \
the queue, so he must wait.  Since his service time was .130504, he departs \
at time ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{".949317", "+", ".130504"}], "=", "1.079821"}], TraditionalForm]]],
 ".  Customer 3 arrives at time .933421 and must line up behind customer 2, \
because at that point customer 1 is still not finished with service. Customer \
3 requires .250825 time units to serve, so this customer departs at time ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1.079821", "+", ".250825"}], "=", "1.330646"}], 
   TraditionalForm]]],
 ".  Meanwhile, customer 4 has come in at time 1.08503, so he has to wait \
until time 1.330646 to begin service.  The departure time of customer 4 is \
then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1.330646", "+", ".53062"}], "=", "1.861266"}], TraditionalForm]]],
 ".  "
}], "Text",
 CellChangeTimes->{{3.40431860828125*^9, 3.404318700359375*^9}, {
  3.404318751578125*^9, 3.404318950875*^9}, {3.404318990546875*^9, 
  3.404319149515625*^9}, {3.404319181296875*^9, 3.404319267109375*^9}, {
  3.40431930578125*^9, 3.40431930578125*^9}, {3.404319343296875*^9, 
  3.404319368359375*^9}, {3.40431940540625*^9, 3.404319461328125*^9}, {
  3.4043195025*^9, 3.404319546640625*^9}, {3.40431997125*^9, 
  3.40432000771875*^9}}],

Cell[TextData[{
 StyleBox["Activity 5",
  FontWeight->"Bold"],
 "  If five successive customer arrival times are: 2.1, 3.4, 4.2, 6.8, 7.4 \
and their service times are: 1.0, 2.3, 1.7, 3.4, 0.6, find the departure \
times of each customer, and find the amount of time each customer is in the \
system.  What is the longest queue length?"
}], "Text",
 CellFrame->True],

Cell[TextData[{
 "\tNotice that any customer's waiting time",
 StyleBox[" in the system ",
  FontColor->GrayLevel[0]],
 "is just his departure time minus his arrival time, so that producing a list \
of waiting times will be simple if we can produce a list of departure times.  \
This too is not hard, because a customer's departure time is his service time \
plus either his arrival time, or the departure time of the previous customer, \
whichever is later.  We can generate this list of departure times iteratively \
by this observation, beginning with the first customer, whose departure time \
is just his arrival time plus his service time.  The next function does this. \
 It takes the arrival time and service time lists as inputs, and returns the \
list of departure times using the strategy we have discussed.  "
}], "Text",
 CellChangeTimes->{{3.4329173696686*^9, 3.4329174216466*^9}, {
  3.4329229677665997`*^9, 3.4329229732806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DepartureTimes", "[", 
   RowBox[{"arrtimelist_", ",", "servtimelist_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numcustomers", ",", "deptimelist", ",", "customer", ",", 
      "nextdeptime"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numcustomers", "=", 
      RowBox[{"Length", "[", "servtimelist", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deptimelist", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"arrtimelist", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"servtimelist", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nextdeptime", "=", 
         RowBox[{
          RowBox[{"servtimelist", "[", 
           RowBox[{"[", "customer", "]"}], "]"}], "+", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"deptimelist", "[", 
             RowBox[{"[", 
              RowBox[{"customer", "-", "1"}], "]"}], "]"}], ",", 
            RowBox[{"arrtimelist", "[", 
             RowBox[{"[", "customer", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"deptimelist", ",", "nextdeptime"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"customer", ",", "2", ",", "numcustomers"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "deptimelist"}]}], "]"}]}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell["\<\
Here we apply the function to the arrival and service lists in the example \
above.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"arrlist", "=", 
   RowBox[{"{", 
    RowBox[{"0.519352", ",", "0.770897", ",", "0.933421", ",", "1.08503"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"servlist", "=", 
   RowBox[{"{", 
    RowBox[{"0.429965", ",", "0.130504", ",", "0.250825", ",", "0.53062"}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{"DepartureTimes", "[", 
  RowBox[{"arrlist", ",", "servlist"}], "]"}]}], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{{3.404319629234375*^9, 3.404319664046875*^9}, {
   3.404319709671875*^9, 3.404319775453125*^9}, {3.404319806984375*^9, 
   3.40431980771875*^9}, 3.404319840578125*^9},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell["\<\
\tNow waiting times are departure times minus arrival times; so we can build \
a function which calls on the functions above, plots a histogram of waiting \
times, and computes the mean and variance.  \
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<KnoxProb7`Utilities`\>\"", "]"}], ";"}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{3.404318102890625*^9, 3.442096606157735*^9},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SimulateWaitingTimes", "[", 
   RowBox[{"arrdist_", ",", "servdist_", ",", "numcustomers_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "arrtimelist", ",", "servtimelist", ",", "deptimelist", ",", 
      "waitimelist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arrtimelist", "=", 
      RowBox[{"SimArrivals", "[", 
       RowBox[{"arrdist", ",", "numcustomers"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"servtimelist", "=", 
      RowBox[{"SimServiceTimes", "[", 
       RowBox[{"servdist", ",", "numcustomers"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"deptimelist", "=", 
      RowBox[{"DepartureTimes", "[", 
       RowBox[{"arrtimelist", ",", "servtimelist"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"waitimelist", "=", 
      RowBox[{"deptimelist", "-", "arrtimelist"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Mean waiting time: \>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{"Mean", "[", "waitimelist", "]"}], "]"}], ",", 
       "\"\< Variance of waiting times: \>\"", ",", 
       RowBox[{"N", "[", 
        RowBox[{"Variance", "[", "waitimelist", "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Histogram", "[", 
      RowBox[{"waitimelist", ",", "6", ",", "\"\<Probability\>\"", ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{
  3.4329175947936*^9, 3.442096634846135*^9, {3.442096751253335*^9, 
   3.4420967893485346`*^9}, {3.4420971352629347`*^9, 3.442097140894535*^9}},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[TextData[{
 "\tHere is an example run in a setting that we already know about: an M/M/1 \
queue with arrival rate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Lambda]", "=", "3"}], TraditionalForm]]],
 " and service rate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", "=", "4"}], TraditionalForm]]],
 ".  The distribution suggested by the histogram in Figure 9(a) does look \
exponential, and the mean waiting time of 1.0601 did come out near the \
theoretical value of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"\[InvisibleComma]", 
       RowBox[{"\[Mu]", "-", "\[Lambda]"}]}], ")"}]}], "=", "1"}], 
   TraditionalForm]]],
 " in this run.  You should try running the command several more times to get \
an idea of the variability.  Also try both increasing and decreasing the \
number of customers.  What do you expect to happen as the number of customers \
gets larger and larger?"
}], "Text",
 CellChangeTimes->{{3.404320113796875*^9, 3.40432011528125*^9}, {
  3.4329176924886*^9, 3.4329176928316*^9}, {3.4329229917086*^9, 
  3.4329229945806*^9}}],

Cell[BoxData[
 RowBox[{"SeedRandom", "[", "9689321", "]"}]], "Input",
 CellFrame->True,
 InitializationCell->True,
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"g1", "=", 
   RowBox[{"SimulateWaitingTimes", "[", 
    RowBox[{
     RowBox[{"ExponentialDistribution", "[", "3", "]"}], ",", 
     RowBox[{"ExponentialDistribution", "[", "4", "]"}], ",", "1000"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"g2", "=", 
   RowBox[{"SimulateWaitingTimes", "[", 
    RowBox[{
     RowBox[{"UniformDistribution", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], "]"}], ",", 
     RowBox[{"UniformDistribution", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5"}], "}"}], "]"}], ",", "1000"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", 
   RowBox[{"g1", ",", "g2"}], "}"}], "]"}]}], "Input",
 CellFrame->True,
 InitializationCell->True,
 CellChangeTimes->{{3.404318125703125*^9, 3.4043181283125*^9}, {
   3.4043200563125*^9, 3.404320075390625*^9}, {3.442096660866935*^9, 
   3.442096666046135*^9}, 3.4420967318781347`*^9},
 AutoStyleOptions->{"FunctionLocalVariableStyle"->None,
 "FunctionNotebookStyle"->None,
 "GlobalSymbolStyle"->None,
 "GlobalToLocalScopeConflictStyle"->None,
 "LocalScopeConflictStyle"->None,
 "LocalVariableStyle"->None,
 "PatternVariableStyle"->None,
 "UndefinedSymbolStyle"->None}],

Cell[TextData[{
 "(a) M/M/1 queue, \[Lambda] = 3 and \[Mu] = 4                            (b) \
U/U/1 queue, \[Rho] = .75\n",
 StyleBox["Figure 6.9",
  FontWeight->"Bold"],
 StyleBox[" ",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox["-",
  FontWeight->"Bold"],
 " Histograms of 1000 waiting times",
 " "
}], "Text",
 CellChangeTimes->{{3.438459794955*^9, 3.438459804443*^9}},
 TextAlignment->Center],

Cell[TextData[{
 "\tOur command allows us to use any interarrival and service distribution we \
choose.  To see another example, we repeat the simulation for a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"uniform", "[", 
    RowBox[{"0", ",", "2"}], "]"}], TraditionalForm]]],
 " interarrival distribution and a ",
 Cell[BoxData[
  FormBox[
   RowBox[{"uniform", "[", 
    RowBox[{"0", ",", "1.5"}], "]"}], TraditionalForm]]],
 " service distribution.  The result is shown in Figure 9(b).  Note that the \
service rate is the reciprocal of the mean time 1/.75, and the arrival rate \
is the reciprocal of the interarrival mean 1/1, so the traffic intensity is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", ".75"}], TraditionalForm]]],
 ".  The distribution of waiting times is rather right-skewed, reminiscent of \
a gamma distribution, and the mean time in system is around 1.42; in \
particular, it is more than the mean time in the M/M/1 simulation even though \
the traffic intensity is the same.  "
}], "Text",
 CellChangeTimes->{{3.40432016853125*^9, 3.40432016871875*^9}, {
   3.4329177610256*^9, 3.4329177616846*^9}, {3.4329230084365997`*^9, 
   3.4329230099365997`*^9}, 3.4571287230809274`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Exercises 6.3", "Subsection",
 CellChangeTimes->{{3.4329178268736*^9, 3.4329178276396*^9}, {
  3.4329230153536*^9, 3.4329230165536003`*^9}},
 TextAlignment->Center,
 FontWeight->"Bold"],

Cell["\<\
1.  Customers waiting in a post office line experience a frustration cost of \
10 cents a minute per customer while they wait.  What target traffic \
intensity should the postal supervisors aim for so that the average \
frustration cost per unit time of the whole queue is 20 cents a minute? \
\>", "Text"],

Cell["\<\
2.  Customers arrive to a department store service desk according to a \
Poisson process with rate 8 per hour.  If it takes 5 minutes on average to \
serve a customer, what is the limiting probability of having at least 2 \
people in the system?  What is the limiting probability that an arriving \
customer can go directly into service?\
\>", "Text"],

Cell["\<\
3.  Derive the differential equation (5) for the short-run M/M/1 system size \
probabilities.\
\>", "Text"],

Cell["\<\
4.  Verify by mathematical induction expression (7) for the limiting M/M/1 \
system size probabilities.\
\>", "Text"],

Cell[TextData[{
 "5.  What, in general, should be the relationship between the expected \
waiting time in the system ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["E",
     FontSlant->"Plain"], "[", "W", "]"}], TraditionalForm]]],
 " and the expected waiting time in the queue ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["E",
     FontSlant->"Plain"], "[", 
    SubscriptBox["W", "q"], "]"}], TraditionalForm]]],
 "?"
}], "Text",
 CellChangeTimes->{{3.4571287353449273`*^9, 3.4571287393939276`*^9}}],

Cell[TextData[{
 "6.  Derive the long-run probability distribution of the time ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "q"], TraditionalForm]]],
 " that a customer spends in queue prior to entering service.  Be careful: \
this random variable has a mixture of a discrete and continuous distribution, \
because there is non-zero probability that ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["W", "q"], TraditionalForm]]],
 " equals 0 exactly, but for states greater than zero there is a sub-density, \
which when integrated from 0 to \[Infinity] gives the complementary \
probability to that of the event ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["W", "q"], "=", "0"}], "}"}], TraditionalForm]]],
 ".  "
}], "Text"],

Cell["\<\
7.  People come to a street vendor selling hot pretzels at a rate of 1 every \
2 minutes.  The vendor serves them at an average time of 1 minute and 30 \
seconds.  Find the long-run probability that a customer will take at least 2 \
minutes to get a pretzel.\
\>", "Text"],

Cell["\<\
8.  The operator of a queueing system must solve an optimization problem in \
which he must balance the competing costs of speeding up service, and making \
his customers wait.  There is a fixed arrival rate of \[Lambda], operating \
costs are proportional to the service rate, and customer inconvenience cost \
is proportional to the expected waiting time of a customer.  Find the optimal \
service rate in terms of \[Lambda] and the proportionality constants. \
\>", "Text"],

Cell[TextData[{
 "9.  (",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ") Use the commands of the section to study the long-run waiting time \
distribution and average waiting time when the interarrival and service time \
distributions are approximately normal.  What do you have to be careful of \
when you choose the parameters of your normal distributions?"
}], "Text"],

Cell[TextData[{
 "10. (",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 ") Build a command that takes a list of arrival and service times and a \
fixed time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ", and returns the number of people in the system at time ",
 StyleBox["t",
  FontSlant->"Italic"],
 ".  Combine your command with the arrival and service time simulators of \
this section to produce a command that simulates and plots the system size as \
a function of ",
 StyleBox["t",
  FontSlant->"Italic"],
 ". "
}], "Text"],

Cell[TextData[{
 "11.  One case in which it is possible to derive the short-run distribution \
of system size is the M/M/1/1 queue.  The extra 1 in the notation stands for \
1 waiting space for the customer in service; hence any new customer arriving \
when someone is already being served is turned away.  Therefore, the system \
size ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "t"], TraditionalForm]]],
 " can only take on the values 0 or 1.  Derive and solve a differential \
equation for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "1"], "(", "t", ")"}], "=", 
    RowBox[{
     RowBox[{
      StyleBox["P",
       FontSlant->"Plain"], "[", 
      RowBox[{
       SubscriptBox["M", "t"], "=", "1"}], "]"}], "=", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{
        SubscriptBox["f", "0"], "(", "t", ")"}]}], "=", 
      RowBox[{"1", "-", 
       RowBox[{
        StyleBox["P",
         FontSlant->"Plain"], "[", 
        RowBox[{
         SubscriptBox["M", "t"], "=", "0"}], "]"}]}]}]}]}], TraditionalForm]]],
 ".  (You will need to make the assumption that the system is empty at time \
0.)"
}], "Text",
 CellChangeTimes->{3.4571288233689275`*^9}],

Cell[TextData[{
 "12.  A self-service queueing system, such as a parking garage or a \
self-service drink area in a restaurant, can be thought of as an M/M/\
\[Infinity] queue, i.e., a queue with an unlimited number of servers.  All \
customers therefore go into service immediately on arrival.  If ",
 StyleBox["n",
  FontSlant->"Italic"],
 " customers are now in such a queue, what is the distribution of the time \
until the next customer is served?  (Assume customers serve themselves at the \
same rate \[Mu].)  Obtain a system of differential equations analogous to (5) \
(case ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "\[GreaterEqual]", "1"}], TraditionalForm]]],
 " only) for the short-run system size probabilities.  You need not attempt \
to solve either the differential equations or the corresponding linear \
equations for the limiting probabilities."
}], "Text"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->None,
ScreenStyleEnvironment->"Working",
WindowSize->{578, 594},
WindowMargins->{{17, Automatic}, {Automatic, 13}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"], None, 
   Cell[
    TextData["Chapter 6  Stochastic Processes and Applications"], "Header"]}, {
   Cell[
    TextData["6.3 Queues"], "Header"], None, 
   Cell[
    TextData[{
      CounterBox["Page"]}], "PageNumber"]}},
ShowCellLabel->False,
Magnification->1.25,
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->FrontEnd`FileName[{"Book"}, "Textbook.nb", 
  CharacterEncoding -> "WindowsANSI"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 274, 7, 68, "Section"],
Cell[844, 31, 2215, 35, 507, "Text"],
Cell[3062, 68, 454, 10, 111, "Text"],
Cell[3519, 80, 413, 11, 48, "Text"],
Cell[3935, 93, 352, 11, 33, "DisplayFormulaNumbered"],
Cell[4290, 106, 2289, 41, 484, "Text"],
Cell[6582, 149, 306, 9, 90, "Text"],
Cell[CellGroupData[{
Cell[6913, 162, 123, 2, 41, "Subsection"],
Cell[7039, 166, 536, 16, 69, "Text"],
Cell[7578, 184, 423, 13, 33, "DisplayFormulaNumbered"],
Cell[8004, 199, 2065, 51, 339, "Text"],
Cell[10072, 252, 2726, 82, 181, "DisplayFormula"],
Cell[12801, 336, 989, 32, 131, "Text"],
Cell[13793, 370, 1082, 39, 131, "Text"],
Cell[14878, 411, 698, 22, 69, "Text"],
Cell[15579, 435, 371, 12, 48, "DisplayFormula"],
Cell[15953, 449, 989, 34, 90, "Text"],
Cell[16945, 485, 870, 34, 90, "Text"],
Cell[17818, 521, 1909, 64, 114, "Text"],
Cell[19730, 587, 1502, 48, 48, "DisplayFormulaNumbered"],
Cell[21235, 637, 366, 14, 27, "Text"],
Cell[21604, 653, 1213, 38, 72, "DisplayFormulaNumbered"],
Cell[22820, 693, 271, 5, 69, "Text"],
Cell[23094, 700, 896, 28, 33, "DisplayFormulaNumbered"],
Cell[23993, 730, 2474, 80, 256, "Text"],
Cell[26470, 812, 1802, 52, 47, "DisplayFormulaNumbered"],
Cell[28275, 866, 547, 17, 48, "Text"],
Cell[28825, 885, 253, 7, 50, "DisplayFormula"],
Cell[29081, 894, 216, 7, 27, "Text"],
Cell[29300, 903, 1306, 40, 94, "DisplayFormula"],
Cell[30609, 945, 351, 15, 64, "Text"],
Cell[30963, 962, 245, 7, 27, "Text"],
Cell[31211, 971, 316, 10, 55, "DisplayFormulaNumbered"],
Cell[31530, 983, 930, 22, 149, "Text"],
Cell[32463, 1007, 632, 19, 40, "DisplayFormulaNumbered"],
Cell[33098, 1028, 386, 9, 69, "Text"],
Cell[33487, 1039, 219, 6, 47, "DisplayFormulaNumbered"],
Cell[33709, 1047, 196, 4, 48, "Text"],
Cell[33908, 1053, 1761, 32, 381, "Text"],
Cell[35672, 1087, 388, 12, 47, "DisplayFormula"],
Cell[36063, 1101, 156, 3, 27, "Text"],
Cell[36222, 1106, 379, 13, 51, "DisplayFormula"],
Cell[36604, 1121, 1652, 45, 256, "Text"],
Cell[38259, 1168, 666, 21, 27, "DisplayFormula"],
Cell[38928, 1191, 490, 12, 69, "Text"],
Cell[39421, 1205, 405, 13, 51, "DisplayFormula"],
Cell[39829, 1220, 133, 1, 27, "Text"],
Cell[39965, 1223, 694, 22, 50, "DisplayFormula"],
Cell[40662, 1247, 525, 13, 90, "Text"],
Cell[41190, 1262, 565, 18, 27, "DisplayFormula"],
Cell[41758, 1282, 398, 9, 69, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42193, 1296, 68, 1, 41, "Subsection"],
Cell[42264, 1299, 3225, 87, 446, "Text"],
Cell[45492, 1388, 3493, 108, 174, "DisplayFormulaNumbered"],
Cell[48988, 1498, 191, 7, 27, "Text"],
Cell[49182, 1507, 511, 16, 33, "DisplayFormulaNumbered"],
Cell[49696, 1525, 1222, 33, 152, "Text"],
Cell[50921, 1560, 1488, 33, 257, "Text"],
Cell[52412, 1595, 583, 17, 50, "DisplayFormula"],
Cell[52998, 1614, 235, 4, 48, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53270, 1623, 60, 1, 41, "Subsection"],
Cell[53333, 1626, 1652, 33, 320, "Text"],
Cell[54988, 1661, 1410, 36, 255, "Input",
 InitializationCell->True],
Cell[56401, 1699, 397, 11, 56, "Input",
 InitializationCell->True],
Cell[56801, 1712, 470, 14, 79, "Input",
 InitializationCell->True],
Cell[57274, 1728, 223, 4, 69, "Text"],
Cell[57500, 1734, 658, 18, 101, "Input",
 InitializationCell->True],
Cell[58161, 1754, 474, 14, 79, "Input",
 InitializationCell->True],
Cell[58638, 1770, 2032, 42, 318, "Text"],
Cell[60673, 1814, 366, 8, 111, "Text"],
Cell[61042, 1824, 944, 15, 193, "Text"],
Cell[61989, 1841, 1895, 52, 343, "Input",
 InitializationCell->True],
Cell[63887, 1895, 107, 3, 27, "Text"],
Cell[63997, 1900, 938, 25, 145, "Input",
 InitializationCell->True],
Cell[64938, 1927, 225, 4, 69, "Text"],
Cell[65166, 1933, 496, 13, 56, "Input",
 InitializationCell->True],
Cell[65665, 1948, 2031, 50, 409, "Input",
 InitializationCell->True],
Cell[67699, 2000, 1111, 28, 152, "Text"],
Cell[68813, 2030, 398, 11, 56, "Input",
 InitializationCell->True],
Cell[69214, 2043, 1230, 34, 189, "Input",
 InitializationCell->True],
Cell[70447, 2079, 419, 14, 49, "Text"],
Cell[70869, 2095, 1208, 25, 193, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72114, 2125, 191, 4, 41, "Subsection"],
Cell[72308, 2131, 316, 5, 90, "Text"],
Cell[72627, 2138, 361, 6, 90, "Text"],
Cell[72991, 2146, 117, 3, 48, "Text"],
Cell[73111, 2151, 127, 3, 48, "Text"],
Cell[73241, 2156, 517, 17, 50, "Text"],
Cell[73761, 2175, 759, 20, 137, "Text"],
Cell[74523, 2197, 282, 5, 69, "Text"],
Cell[74808, 2204, 486, 7, 131, "Text"],
Cell[75297, 2213, 377, 8, 90, "Text"],
Cell[75677, 2223, 533, 17, 90, "Text"],
Cell[76213, 2242, 1203, 35, 152, "Text"],
Cell[77419, 2279, 880, 17, 173, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
